(this.webpackJsonpparent=this.webpackJsonpparent||[]).push([[0],{41:function(e,i,s){e.exports=s(77)},76:function(e,i,s){},77:function(e,i,s){"use strict";s.r(i);var t=s(0),a=s.n(t),n=s(38),o=s.n(n),r=s(40),p=s(39),l=s.n(p);const c=({webApiBridge:e,apis:i})=>({webApiBridge:e,apis:i,findApiOfType(e){return this.webApiBridge.apis.find(i=>i instanceof g[e])}}),d=(e,i)=>(s,t,a)=>i[s]?e(s,t,a):(console.log("".concat(s," was not registered")),null);class h{}h.instances=[],h.add=e=>h.instances.push(e),h.executeOnType=(e,i)=>{h.instances.forEach(s=>{const t=s.findApiOfType(e);t&&i(t)})};const g={Common:class{constructor(){this.setSend=e=>{this.send=d(e,this.outgoingCalls)},this.displayBlur=e=>{this.send("displayBlur",[e],!1)},this.displayGrayscale=e=>{this.send("displayGrayscale",[e],!1)},this.outgoingCalls={displayBlur:null,displayGrayscale:null}}},Api1:class{constructor(){this.setSend=e=>{this.send=d(e,this.outgoingCalls)},this.photoSelected=e=>{this.send("photoSelected",[e],!1)},this.outgoingCalls={photoSelected:null}}},Api2:class{constructor(){this.setSend=e=>{this.send=d(e,this.outgoingCalls)},this.photoClicked=e=>{h.executeOnType("Api1",i=>i.photoSelected(e)),h.executeOnType("Api2",e=>{e!==this&&e.displayNewPhoto()})},this.displayNewPhoto=()=>{this.send("displayNewPhoto",null,!1)},this.outgoingCalls={displayNewPhoto:null}}},Api3:class{constructor(){this.setSend=()=>{},this.setGrayscale=e=>{h.executeOnType("Common",i=>i.displayGrayscale(e))},this.setBlur=e=>{h.executeOnType("Common",i=>i.displayBlur(e))}}}};class b extends a.a.Component{constructor(e){super(e),this.messageListener=e=>{e&&e.source===this.webApiBridge.target&&this.webApiBridge.onMessage(e,e.data)},this.startApis=()=>new Promise(e=>e({type:this.type,apis:this.apis})),this.registerCallback=(e,i)=>new Promise(s=>{const t=this.webApiBridge.apis.find(i=>void 0!==i.outgoingCalls[e]);if(!t)throw new Error("registerCallback failed, ".concat(e," does not exist"));t.outgoingCalls[e]=i,s()}),this.setIframe=e=>{e&&!this.iframe&&(this.iframe=e,this.webApiBridge.target=e.contentWindow)};const i=e.src,s=e.type,t=e.apis,a=new URL(i);this.type=s,this.apis=t,this.webApiBridge=new l.a,this.webApiBridge.origin=a.origin,this.webApiBridge.targetOrigin=a.origin;const n=this.webApiBridge.send.bind(this.webApiBridge);h.add(c({webApiBridge:this.webApiBridge,apis:t})),window.addEventListener("message",this.messageListener),this.webApiBridge.apis=t.map(e=>{const i=new g[e];return i.setSend(n),i}),this.webApiBridge.apis.push(this)}componentWillUnmount(){this.webApiBridge.apis.forEach(e=>{const i=e;i.outgoingCalls&&Object.keys(i.outgoingCalls).forEach(e=>{i.outgoingCalls[e]=null})}),window.removeEventListener("message",this.messageListener)}render(){const e=this.props,i=e.src,s=(e.type,e.apis,Object(r.a)(e,["src","type","apis"]));return console.log("render iframe: ".concat(i)),a.a.createElement("iframe",Object.assign({src:i,title:i,ref:e=>{this.setIframe(e)},scrolling:"no"},s))}}var m=b;s(76);const u={src:"https://precor.github.io/web-api-bridge/examples/webapp-library/webapp1/build/",type:"LibType1",apis:["Common","Api1"]},w=[{src:"https://precor.github.io/web-api-bridge/examples/webapp-library/webapp1/build/",type:"LibType2",apis:["Common","Api2","Api3"]},{src:"https://precor.github.io/web-api-bridge/examples/webapp-library/webapp1/build/",type:"LibType2",apis:["Common","Api2"]},{src:"https://precor.github.io/web-api-bridge/examples/webapp-library/webapp2/build/",type:"LibType2",apis:["Common","Api2"]},{src:"https://precor.github.io/web-api-bridge/examples/webapp-library/webapp2/build/",type:"LibType2",apis:["Common","Api2"]}];var y=()=>(console.log("render parent"),a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(m,{className:"fullscreen-iframe",src:u.src,type:u.type,apis:u.apis})),a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"row"},w.map(({src:e,type:i,apis:s},t)=>a.a.createElement(m,{className:"image-select",key:"LibType2_".concat(t),src:e,type:i,apis:s}))),a.a.createElement("div",{className:"overlay-text"},"Click on one of the 4 photos"))));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})}},[[41,1,2]]]);
//# sourceMappingURL=main.55b31d15.chunk.js.map